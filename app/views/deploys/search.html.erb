<h1><%= title %></h1>

<div class="search" ng-controller="<%= controller %>">
  <input type=hidden  id=default_time_format value="<%= current_user.time_format %>">


  <div class="row">
    <%= form_tag("/deploys/search", method: "get") do %>
      <div class="search-form col-sm-2">
        <%= label_tag(:deployer, "Deployer") %>
        <%= text_field_tag(:deployer, params[:deployer], placeholder: 'deployer name') %>
      </div>

      <div class="search-form col-sm-2">
        <%= label_tag(:project_name, "Project") %>
        <%= text_field_tag(:project_name, params[:project_name], placeholder: 'project name') %>
      </div>

      <div class="search-form col-sm-2">
        <%= label_tag(:production, "Production") %>
        <%= select_tag(:production, options_for_select(["true", "false"], selected: params[:production]), { prompt: 'select',  class: "form-control" } ) %>
      </div>

      <div class="search-form col-sm-2">
        <%= label_tag(:status, "Status") %>
        <%= select_tag(:status, options_for_select(Job::VALID_STATUSES, selected: params[:status]), { prompt: 'all', class: 'form-control' } ) %>
      </div>

      <div class="search-form col-md-2 clearfix">
        <%= label(:time_format, "Time Format") %>
        <%= select_tag(:time_format, options_for_select(User::TIME_FORMATS, selected: params[:time_format] ? params[:time_format] : 'relative'), { class: 'form-control' } ) %>
      </div>

      <div class="search-form col-md-2 clearfix">
        Search:<BR>
        <div class="btn btn-default">
          <%= submit_tag("Submit") %>
        </div>
      </div>
    <% end %>
  </div>


  </div>

  <section class="search-content clearfix">
    <div class="deploy-csv">
      <%= link_to "Download as CSV", recent_deploys_path(format: "csv") %>
    </div>
    <%= paginate @deploys %>
    <table class="search-content">
      <tr>
        <th>PROJECT</th>
        <th>USER</th>
        <th>DEPLOY</th>
        <th>LAST UPDATE</th>
        <th>STATUS</th>
      </tr>
      <% if @deploys.count > 0 %>
        <tbody>
          <%= render partial: "search_results", collection: @deploys %>
        </tbody>
      <% end %>
    </table>
    <%= paginate @deploys %>
  </section>
</div>
