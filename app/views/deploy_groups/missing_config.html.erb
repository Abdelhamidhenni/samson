<%= page_title "#{@deploy_group.name} Missing Config" %>

<section class="form-horizontal">
  <%= form_tag "?", method: :get, class: "form-horizontal" do %>
    <div class="col-md-2">
      <%= label_tag "Deploy group" %>
    </div>
    <div class="col-md-2">
      <%= live_select_tag :compare, options_from_collection_for_select(DeployGroup.where.not(id: @deploy_group.id).sort_by(&:natural_order), :permalink, :name) %>
    </div>
    <div class="col-md-2">
      <%= submit_tag "Compare", class: 'btn btn-primary' %>
    </div>
    <br/><br/>

    <% if @diff %>
      <% if @diff.empty? %>
        No diff found!
      <% else %>
        <% @diff.each do |section, diff| %>
          <h2><%= section %></h2>
          <table class="table">
            <tr><th>Item</th><th>Value</th></tr>
            <% diff.each do |data| %>
              <td><%= link_to *data.fetch(:item) %></td>
              <td><%= data.fetch(:value) %></td>
            <% end %>
          </table>
        <% end %>
      <% end %>
    <% end %>
  <% end %>
</section>
